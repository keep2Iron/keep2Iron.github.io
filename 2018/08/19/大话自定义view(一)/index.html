<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 大话自定义view(1) · Keep2iron's Road to development</title><meta name="description" content="大话自定义view(1) - Keep2iron"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://keep2iron.github.io/atom.xml" title="Keep2iron's Road to development"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/Keep2iron" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/keep2iron" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">大话自定义view(1)</h1><div class="post-info">Aug 19, 2018</div><div class="post-content"><h5>出师不利</h5>

<p>小艾从新兵训练营毕业，在训练营中学习不少编程方面的知识，学着编写了不少Android方面的小程序，他踌躇满志一心想要报考<em>Android调查兵团</em>。终于当投递了无数次申请了之后，调查兵团准许了小艾的申请，并给与了他一次面试的机会。</p>
<p>到了要进行面试的日子，考官发放了一个题目，上面写道：“<strong>请编写一个如下图的自定义控件</strong>”</p>
<p><img src="https://i.imgur.com/X1ZyPpl.png" alt="pic1"></p>
<a id="more"></a>
<p>小艾心想糟了，身上这一身本事都是CV老师教的(PS:老夫敲代码就是一梭子.png)，自己写这自定义控件还真的是不太行阿~。小艾心灰意冷的答完了题目，垂头丧一些气的回到了自己的房间，痛定思痛心想：这自定义控件劳资一定要攻破它，说着小艾就打开了aoogle搜索了一下这自定义控件的一些知识。</p>
<p></p><h5>开始的一步</h5>小艾：哦，这第一步原来是要继承一个View或者一个ViewGroup​，我这个自定义控件是一个圆形进度条，那么我就起名叫<strong>CircleProgressView</strong>吧！<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CircleProgress</span> <span class="keyword">extends</span> <span class="title">View</span></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">CircleProgress</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>(context, <span class="keyword">null</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//@Nullable是android扩展包的注解，标识这个变量是可以为null的</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">CircleProgress</span><span class="params">(Context context, @Nullable AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>(context, attrs, <span class="number">0</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">CircleProgress</span><span class="params">(Context context, @Nullable AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p>可是这自定义View为啥要重写了这三个方法呢？小艾这是产生了一个疑惑，不过正好今天是一个星期六，</p>
<p>2.重写构造方法。</p>
<p>重写的时候系统会提示重写构造方法，而这里我们基本上重写了三种构造方法。</p>
<p>在这里说下为什么要重写三个构造方法呢？</p>
<p>这里与我们生成自定义控件的方式有着密切的关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成ProgressView的方式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//直接在代码中new出来，这里的生成方式在于生成的view控件没有LayoutParams，也就是他目前没有大小，没有父容器，只是直接new出来</span></span><br><span class="line">ProgressView view = <span class="keyword">new</span> ProgressView(ctx);</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//使用布局文件生成。</span><br><span class="line"><span class="tag">&lt;<span class="name">keep2iron.github.io.customview.widget.ProgressView</span></span></span><br><span class="line"><span class="tag">   <span class="attr">app:pv_default_color</span>=<span class="string">"#eeeeee"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">app:pv_color</span>=<span class="string">"#ffa72a"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:text</span>=<span class="string">"123456"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_width</span>=<span class="string">"50dp"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_height</span>=<span class="string">"50dp"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<h6 id="tip"><a href="#tip" class="headerlink" title="tip:"></a>tip:</h6><h6 id="在第一种new出来的生成方式的时候，会调用一个参数的构造方法。"><a href="#在第一种new出来的生成方式的时候，会调用一个参数的构造方法。" class="headerlink" title="在第一种new出来的生成方式的时候，会调用一个参数的构造方法。"></a>在第一种new出来的生成方式的时候，会调用一个参数的构造方法。</h6><h6 id="第二种使用xml声明的方式则会调用两个参数的构造方法。"><a href="#第二种使用xml声明的方式则会调用两个参数的构造方法。" class="headerlink" title="第二种使用xml声明的方式则会调用两个参数的构造方法。"></a>第二种使用xml声明的方式则会调用两个参数的构造方法。</h6><h6 id="第三个构造方法具有三个参数，第三个参数的意义在于在当前主题中包含了style资源的一个属性值，适用于对于当前view的一个默认style。需要特别指出的是三个参数的构造方法系统是不进行调用的，需要我们这里显式的进行调用，比如我们的Button通过调用，并传递了com-android-internal-R-attr-buttonStyle，而在4-4的主题文件是holo风格，然后定义了button的默认的几个属性"><a href="#第三个构造方法具有三个参数，第三个参数的意义在于在当前主题中包含了style资源的一个属性值，适用于对于当前view的一个默认style。需要特别指出的是三个参数的构造方法系统是不进行调用的，需要我们这里显式的进行调用，比如我们的Button通过调用，并传递了com-android-internal-R-attr-buttonStyle，而在4-4的主题文件是holo风格，然后定义了button的默认的几个属性" class="headerlink" title="第三个构造方法具有三个参数，第三个参数的意义在于在当前主题中包含了style资源的一个属性值，适用于对于当前view的一个默认style。需要特别指出的是三个参数的构造方法系统是不进行调用的，需要我们这里显式的进行调用，比如我们的Button通过调用，并传递了com.android.internal.R.attr.buttonStyle，而在4.4的主题文件是holo风格，然后定义了button的默认的几个属性"></a>第三个构造方法具有三个参数，第三个参数的意义在于在当前主题中包含了style资源的一个属性值，适用于对于当前view的一个默认style。<font color="red">需要特别指出的是三个参数的构造方法系统是不进行调用的，需要我们这里显式的进行调用，比如我们的Button通过调用，并传递了com.android.internal.R.attr.buttonStyle，而在4.4的主题文件是holo风格，然后定义了button的默认的几个属性</font></h6><h6 id="exp"><a href="#exp" class="headerlink" title="exp:"></a>exp:</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">this</span>(context, <span class="keyword">null</span>);</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; <span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">this</span>(context, attrs, com.android.internal.R.attr.buttonStyle);</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; <span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">super</span>(context, attrs, defStyle);</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; &lt;style name=<span class="string">"Theme.DeviceDefault"</span> parent=<span class="string">"Theme.Holo"</span> &gt;</span><br><span class="line">&gt;     ...</span><br><span class="line">&gt;     &lt;item name="buttonStyle"&gt;@android:style/Widget.DeviceDefault.Button&lt;/item&gt;</span><br><span class="line">&gt;     ....</span><br><span class="line">&gt; &lt;/style&gt;</span><br><span class="line">&gt;       </span><br><span class="line">&gt; &lt;style name=<span class="string">"Widget.DeviceDefault.Button"</span> parent=<span class="string">"Widget.Holo.Button"</span> &gt;</span><br><span class="line">&gt; &lt;/style&gt;</span><br><span class="line">&gt;       </span><br><span class="line">&gt; &lt;style name=<span class="string">"Widget.Holo.Button"</span> parent=<span class="string">"Widget.Button"</span>&gt;</span><br><span class="line">&gt; 	&lt;item name="android:background"&gt;@android:drawable/btn_default_holo_dark&lt;/item&gt;</span><br><span class="line">&gt;     &lt;item name="android:textAppearance"&gt;?android:attr/textAppearanceMedium&lt;/item&gt;</span><br><span class="line">&gt;     &lt;item name="android:textColor"&gt;@android:color/primary_text_holo_dark&lt;/item&gt;</span><br><span class="line">&gt;     &lt;item name="android:minHeight"&gt;48dip&lt;/item&gt;</span><br><span class="line">&gt;     &lt;item name="android:minWidth"&gt;64dip&lt;/item&gt;</span><br><span class="line">&gt; &lt;/style&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h6 id="以上基本上重写一个自定义view的构造函数的基本流程"><a href="#以上基本上重写一个自定义view的构造函数的基本流程" class="headerlink" title="以上基本上重写一个自定义view的构造函数的基本流程"></a>以上基本上重写一个自定义view的构造函数的基本流程</h6><h6 id="3-重写onMeasure和onLayout"><a href="#3-重写onMeasure和onLayout" class="headerlink" title="3.重写onMeasure和onLayout"></a>3.重写onMeasure和onLayout</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">&gt; 	<span class="comment">//获取测量的宽度和高度</span></span><br><span class="line">&gt;     <span class="keyword">int</span> widthSize = getMeasureSize(widthMeasureSpec);</span><br><span class="line">&gt;     <span class="keyword">int</span> heightSize = getMeasureSize(heightMeasureSpec);</span><br><span class="line">&gt;</span><br><span class="line">&gt;     <span class="keyword">int</span> size = widthSize &gt; heightSize ? heightSize : widthSize;</span><br><span class="line">&gt;     <span class="comment">//必须调用这个方法，进行设置大小</span></span><br><span class="line">&gt;     setMeasuredDimension(size,size);</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt;   <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getMeasureSize</span><span class="params">(<span class="keyword">int</span> measureSpec)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">int</span> mode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">&gt;     <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">&gt;</span><br><span class="line">&gt;     <span class="keyword">switch</span>(mode)&#123;</span><br><span class="line">&gt;       <span class="keyword">case</span> MeasureSpec.EXACTLY:</span><br><span class="line">&gt;       <span class="keyword">case</span> MeasureSpec.AT_MOST:</span><br><span class="line">&gt;         size = MeasureSpec.getSize(measureSpec);</span><br><span class="line">&gt;         <span class="keyword">break</span>;</span><br><span class="line">&gt;       <span class="keyword">case</span> MeasureSpec.UNSPECIFIED:</span><br><span class="line">&gt;         size = CommonUtil.dp2px(getContext(),<span class="number">50</span>);</span><br><span class="line">&gt;         <span class="keyword">break</span>;</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;     <span class="keyword">return</span> size;</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt; 	<span class="comment">//决定了我们自己的控件相对与父控件的位置</span></span><br><span class="line">&gt;   <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onLayout</span><span class="params">(<span class="keyword">boolean</span> changed, <span class="keyword">int</span> left, <span class="keyword">int</span> top, <span class="keyword">int</span> right, <span class="keyword">int</span> bottom)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">super</span>.onLayout(changed, left, top, right, bottom);</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h6 id="在这里引用郭霖大大博客的一句话。this-is-source-gt-blog"><a href="#在这里引用郭霖大大博客的一句话。this-is-source-gt-blog" class="headerlink" title="在这里引用郭霖大大博客的一句话。this is source =&gt; blog"></a>在这里引用郭霖大大博客的一句话。this is source =&gt; <a href="http://blog.csdn.net/guolin_blog/article/details/16330267" target="_blank" rel="noopener">blog</a></h6><h6 id="EXACTLY"><a href="#EXACTLY" class="headerlink" title="EXACTLY"></a>EXACTLY</h6><h6 id="表示父视图希望子视图的大小应该是由specSize的值来决定的，系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。"><a href="#表示父视图希望子视图的大小应该是由specSize的值来决定的，系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。" class="headerlink" title="表示父视图希望子视图的大小应该是由specSize的值来决定的，系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。"></a>表示父视图希望子视图的大小应该是由specSize的值来决定的，系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。</h6><h6 id="AT-MOST"><a href="#AT-MOST" class="headerlink" title="AT_MOST"></a>AT_MOST</h6><h6 id="表示子视图最多只能是specSize中指定的大小，开发人员应该尽可能小得去设置这个视图，并且保证不会超过specSize。系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。"><a href="#表示子视图最多只能是specSize中指定的大小，开发人员应该尽可能小得去设置这个视图，并且保证不会超过specSize。系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。" class="headerlink" title="表示子视图最多只能是specSize中指定的大小，开发人员应该尽可能小得去设置这个视图，并且保证不会超过specSize。系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。"></a>表示子视图最多只能是specSize中指定的大小，开发人员应该尽可能小得去设置这个视图，并且保证不会超过specSize。系统默认会按照这个规则来设置子视图的大小，开发人员当然也可以按照自己的意愿设置成任意的大小。</h6><h6 id="UNSPECIFIED"><a href="#UNSPECIFIED" class="headerlink" title="UNSPECIFIED"></a>UNSPECIFIED</h6><h6 id="表示开发人员可以将视图按照自己的意愿设置成任意的大小，没有任何限制。这种情况比较少见，不太会用到。"><a href="#表示开发人员可以将视图按照自己的意愿设置成任意的大小，没有任何限制。这种情况比较少见，不太会用到。" class="headerlink" title="表示开发人员可以将视图按照自己的意愿设置成任意的大小，没有任何限制。这种情况比较少见，不太会用到。"></a>表示开发人员可以将视图按照自己的意愿设置成任意的大小，没有任何限制。这种情况比较少见，不太会用到。</h6><h6 id="4-初始化控件的大小位置"><a href="#4-初始化控件的大小位置" class="headerlink" title="4.初始化控件的大小位置"></a>4.初始化控件的大小位置</h6><h6 id="一般我觉得写自定义控件来说，获取他的大小基本上必不可少，那么在什么函数获取大小比较合适呢？我个人认为在onSizeChanged-int-w-int-h-int-oldw-int-oldh-这个方法中进行赋值大小比较合适。"><a href="#一般我觉得写自定义控件来说，获取他的大小基本上必不可少，那么在什么函数获取大小比较合适呢？我个人认为在onSizeChanged-int-w-int-h-int-oldw-int-oldh-这个方法中进行赋值大小比较合适。" class="headerlink" title="一般我觉得写自定义控件来说，获取他的大小基本上必不可少，那么在什么函数获取大小比较合适呢？我个人认为在onSizeChanged(int w, int h, int oldw, int oldh) 这个方法中进行赋值大小比较合适。"></a>一般我觉得写自定义控件来说，获取他的大小基本上必不可少，那么在什么函数获取大小比较合适呢？我个人认为在onSizeChanged(int w, int h, int oldw, int oldh) 这个方法中进行赋值大小比较合适。</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSizeChanged</span><span class="params">(<span class="keyword">int</span> w, <span class="keyword">int</span> h, <span class="keyword">int</span> oldw, <span class="keyword">int</span> oldh)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="keyword">super</span>.onSizeChanged(w, h, oldw, oldh);</span><br><span class="line">&gt; 	<span class="comment">//初始化画笔的宽度</span></span><br><span class="line">&gt;     <span class="keyword">int</span> strokeSize = (<span class="keyword">int</span>) (getMeasuredWidth() / <span class="number">2</span> * <span class="number">0.3f</span>);</span><br><span class="line">&gt;     <span class="keyword">int</span> size = <span class="number">10</span> + strokeSize;</span><br><span class="line">&gt;     <span class="comment">//初始化绘制区域</span></span><br><span class="line">&gt;     mDrawRect = <span class="keyword">new</span> RectF(getPaddingLeft() + size,getPaddingTop() + size,getWidth() - 					getPaddingLeft() - size,getHeight() - getPaddingBottom() - size);</span><br><span class="line">&gt;     mPaint.setStrokeWidth(strokeSize);</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h6 id="5-进行绘制view"><a href="#5-进行绘制view" class="headerlink" title="5.进行绘制view"></a>5.进行绘制view</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">&gt;     <span class="comment">//保存画布的当前状态</span></span><br><span class="line">&gt;     canvas.save();</span><br><span class="line">&gt;     <span class="comment">//旋转画布逆时针90°，那么坐标系就发生了旋转了。</span></span><br><span class="line">&gt;     canvas.rotate(-<span class="number">90</span>,mDrawRect.centerX(),mDrawRect.centerY());</span><br><span class="line">&gt;     <span class="comment">//设置背景圆的颜色</span></span><br><span class="line">&gt;     mPaint.setColor(mDefColor);</span><br><span class="line">&gt;     canvas.drawCircle(mDrawRect.centerX(),mDrawRect.centerY(),mDrawRect.width() / <span class="number">2</span>,mPaint);</span><br><span class="line">&gt;     <span class="comment">//设置弧线的颜色</span></span><br><span class="line">&gt;     mPaint.setColor(mColor);</span><br><span class="line">&gt;     canvas.drawArc(mDrawRect,<span class="number">0</span>,mProgress * <span class="number">360</span>,<span class="keyword">false</span>,mPaint);</span><br><span class="line">&gt;     <span class="comment">//重新恢复画布</span></span><br><span class="line">&gt;     canvas.restore();</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="最后面整个view的绘制就完成了。附上代码的链接。"><a href="#最后面整个view的绘制就完成了。附上代码的链接。" class="headerlink" title="最后面整个view的绘制就完成了。附上代码的链接。"></a>最后面整个view的绘制就完成了。附上代码的链接。</h5></div></article></div></main><footer><div class="paginator"><a href="/2018/08/19/ReactNative/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'keep2iron';
var disqus_identifier = '2018/08/19/大话自定义view(一)/';
var disqus_title = '大话自定义view(1)';
var disqus_url = 'https://keep2iron.github.io/2018/08/19/大话自定义view(一)/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//keep2iron.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2018 <a href="https://keep2iron.github.io">Keep2iron</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>